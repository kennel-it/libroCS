<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html>
<!-- grafoIndice requires="json" group="javascript" -->
<!-- changelog 2018-02-21 inserita prima parte dei contenuti -->
<!-- changelog 2020-03-01 inseriti link, alcune precisazioni e rimosso "work in progress" -->
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
   	<meta charset="UTF-8"/>
       <title>elaborazioneJsonClient</title>
       <link type="text/css" rel="stylesheet" href="style.css"/>
       <script type="text/javascript" src="script/test.js"></script>         
   </head>
<body>
<header>
	<h1>elaborazioneJsonClient</h1>
	<p>gestire una risposta in formato application/json via JavaScript</p>
</header>
<article>
	<p>Come linguaggio lato client prendiamo in considerazione soltanto JavaScript 
	(ma per esestono delle librerie per gli altri linguaggi) e la gestione dei
	messaggi JSON è davvero semplice.</p>
	
	<p>Il nome stesso del formato (JavaScript Object Notation) 
	ci da indicazioni sulla sua semplicità di uso con JavaScript che
	ci mette a disposizione un oggetto predefinito 
	<a href="https://developer.mozilla.org/it/docs/Web/JavaScript/Reference/Global_Objects/JSON">JSON</a>
	per trasformare un testo JSON in un oggetto e viceversa.</p>
	
	<p>Per convertire una stringa in un oggetto basta usare il metodo
	<code>parse()</code> dell'oggetto <code>JSON</code>.</p>
	<p><code>JSON.parse(testo)</code> restituisce un oggetto costruito come specificato
	nella stringa <code>testo</code>.</p>

	<h2>Esempio</h2>
	<p>Normalmente il messaggio JSON viene da un server o da un sistema di archiviazione
	ma nella sostanza il modo di lavorarci è quello qui sotto:</p>

<div class="prog">
// invento un messaggio
var messaggioDalServer = '{ "nome":"Pluto", "telefoni": ["555-1111","555-2222"] }';
// trasformo il testo in un oggetto
var oggetto = JSON.parse(messaggioDalServer);
console.log(oggetto.telefoni[1]);
</div>
	<div class="test">
	   	<p>Cosa stampa il precedente frammento di programma nella console?</p>
	    <a onclick="sbagliata(this)">Pluto 555-2222<span class="spiegazione">no, il nome non viene stampatohernet</span></a>
	    <a onclick="sbagliata(this)">555-1111<span class="spiegazione">questo sarebbe l'indice zero</span></a> 
	    <a onclick="giusta(this)">555-2222</a> 
	</div>

<div class="prog">
var messaggioDalServer='{ "nome":"Pluto", "telefoni": ["555-1111","555-2222"] }';
var oggetto = JSON.parse(messaggioDalServer);
console.log(oggetto.Pluto);
</div>	
	<div class="test">
	   	<p>Cosa stampa il precedente frammento di programma nella console?</p>
	    <a onclick="sbagliata(this)">nome<span class="spiegazione">no, la proprietà "Pluto" non esiste</span></a>
	    <a onclick="sbagliata(this)">stringa vuota<span class="spiegazione">no, c'è un valore specifico</span></a> 
	    <a onclick="giusta(this)">undefined</a> 
	</div>
	
</article>
</body>
</html>